const toolpath = {
  movementMoves: [
    {
      id: 1,
      duration: 1,
      type: 4,
      reference: 0,
      points: [
        [0, 0, 0],
        [0, 0, 0],
        [2.18508, 6.724985, 3.279999],
        [2.18508, 6.724985, 3.279999],
      ],
      num_points: 4,
    },
    {
      id: 2,
      duration: 0,
      type: 1,
      reference: 0,
      points: [
        [2.18508, 6.724985, 3.279999],
        [2.18508, 6.724985, 3.279999],
      ],
      num_points: 2,
    },
    {
      id: 3,
      duration: 9,
      type: 4,
      reference: 0,
      points: [
        [2.18508, 6.724985, 3.279999],
        [2.18508, 6.724985, 3.279999],
        [274.02694072928335, 134.01207291921577, 13.279999],
        [6.724985, -2.18508, 13.279999],
      ],
      num_points: 4,
    },
    {
      id: 4,
      duration: 1,
      type: 1,
      reference: 0,
      points: [
        [6.724985, -2.18508, 13.279999],
        [-2.18508, -6.724985, 13.279999],
      ],
      num_points: 2,
    },
    {
      id: 5,
      duration: 12,
      type: 4,
      reference: 0,
      points: [
        [-2.18508, -6.724985, 13.279999],
        [-269.4870357292834, -142.92213791921577, 13.279999],
        [269.4870357292834, 142.92213791921577, 3.279999],
        [2.18508, 6.724985, 3.279999],
      ],
      num_points: 4,
    },
    {
      id: 6,
      duration: 1,
      type: 1,
      reference: 0,
      points: [
        [2.18508, 6.724985, 3.279999],
        [-6.724985, 2.18508, 3.279999],
      ],
      num_points: 2,
    },
    {
      id: 7,
      duration: 15,
      type: 4,
      reference: 0,
      points: [
        [-6.724985, 2.18508, 3.279999],
        [-274.02694072928335, -134.01207291921577, 3.279999],
        [-134.01207291921577, 274.02694072928335, 3.279999],
        [2.18508, 6.724985, 3.279999],
      ],
      num_points: 4,
    },
    {
      id: 8,
      duration: 1,
      type: 1,
      reference: 0,
      points: [
        [2.18508, 6.724985, 3.279999],
        [6.724985, -2.18508, 3.279999],
      ],
      num_points: 2,
    },
    {
      id: 9,
      duration: 12,
      type: 4,
      reference: 0,
      points: [
        [6.724985, -2.18508, 3.279999],
        [142.92213791921577, -269.4870357292834, 3.279999],
        [-142.92213791921577, 269.4870357292834, 13.279999],
        [-6.724985, 2.18508, 13.279999],
      ],
      num_points: 4,
    },
    {
      id: 10,
      duration: 1,
      type: 1,
      reference: 0,
      points: [
        [-6.724985, 2.18508, 13.279999],
        [-2.18508, -6.724985, 13.279999],
      ],
      num_points: 2,
    },
    {
      id: 11,
      duration: 12,
      type: 4,
      reference: 0,
      points: [
        [-2.18508, -6.724985, 13.279999],
        [134.01207291921577, -274.02694072928335, 13.279999],
        [-134.01207291921577, 274.02694072928335, 13.279999],
        [2.18508, 6.724985, 13.279999],
      ],
      num_points: 4,
    },
    {
      id: 12,
      duration: 1,
      type: 1,
      reference: 0,
      points: [
        [2.18508, 6.724985, 13.279999],
        [6.724985, -2.18508, 13.279999],
      ],
      num_points: 2,
    },
    {
      id: 13,
      duration: 15,
      type: 4,
      reference: 0,
      points: [
        [6.724985, -2.18508, 13.279999],
        [142.92213791921577, -269.4870357292834, 13.279999],
        [6.724985, -2.18508, 313.279999],
        [6.724985, -2.18508, 13.279999],
      ],
      num_points: 4,
    },
    {
      id: 14,
      duration: 1,
      type: 1,
      reference: 0,
      points: [
        [6.724985, -2.18508, 13.279999],
        [6.724985, -2.18508, 3.279999],
      ],
      num_points: 2,
    },
    {
      id: 15,
      duration: 12,
      type: 4,
      reference: 0,
      points: [
        [6.724985, -2.18508, 3.279999],
        [6.724985, -2.18508, -296.720001],
        [2.18508, 6.724985, 313.279999],
        [2.18508, 6.724985, 13.279999],
      ],
      num_points: 4,
    },
    {
      id: 16,
      duration: 1,
      type: 1,
      reference: 0,
      points: [
        [2.18508, 6.724985, 13.279999],
        [2.18508, 6.724985, 3.279999],
      ],
      num_points: 2,
    },
    {
      id: 17,
      duration: 12,
      type: 4,
      reference: 0,
      points: [
        [2.18508, 6.724985, 3.279999],
        [2.18508, 6.724985, -296.720001],
        [-6.724985, 2.18508, 313.279999],
        [-6.724985, 2.18508, 13.279999],
      ],
      num_points: 4,
    },
    {
      id: 18,
      duration: 1,
      type: 1,
      reference: 0,
      points: [
        [-6.724985, 2.18508, 13.279999],
        [-6.724985, 2.18508, 3.279999],
      ],
      num_points: 2,
    },
    {
      id: 19,
      duration: 10,
      type: 4,
      reference: 0,
      points: [
        [-6.724985, 2.18508, 3.279999],
        [-6.724985, 2.18508, -296.720001],
        [-6.724985, 2.18508, 13.279999],
        [-6.724985, 2.18508, 13.279999],
      ],
      num_points: 4,
    },
    {
      id: 20,
      duration: 0,
      type: 1,
      reference: 0,
      points: [
        [-6.724985, 2.18508, 13.279999],
        [-6.724985, 2.18508, 13.279999],
      ],
      num_points: 2,
    },
    {
      id: 21,
      duration: 1,
      type: 4,
      reference: 0,
      points: [
        [-6.724985, 2.18508, 13.279999],
        [-6.724985, 2.18508, 13.279999],
        [2.18508, 6.724985, 13.279999],
        [2.18508, 6.724985, 13.279999],
      ],
      num_points: 4,
    },
    {
      id: 22,
      duration: 0,
      type: 1,
      reference: 0,
      points: [
        [2.18508, 6.724985, 13.279999],
        [2.18508, 6.724985, 13.279999],
      ],
      num_points: 2,
    },
    {
      id: 23,
      duration: 9,
      type: 4,
      reference: 0,
      points: [
        [2.18508, 6.724985, 13.279999],
        [2.18508, 6.724985, 13.279999],
        [269.4870357292834, 142.92213791921577, 13.279999],
        [2.18508, 6.724985, 13.279999],
      ],
      num_points: 4,
    },
    {
      id: 24,
      duration: 1,
      type: 1,
      reference: 0,
      points: [
        [2.18508, 6.724985, 13.279999],
        [-6.724985, 2.18508, 13.279999],
      ],
      num_points: 2,
    },
    {
      id: 25,
      duration: 334,
      type: 4,
      reference: 0,
      points: [
        [-6.724985, 2.18508, 13.279999],
        [-274.02694072928335, -134.01207291921577, 13.279999],
        [-10000, 0, 0],
        [-10000, 0, 0],
      ],
      num_points: 4,
    },
    {
      id: 26,
      duration: 1,
      type: 1,
      reference: 0,
      points: [
        [-10000, 0, 0],
        [10000, 0, 0],
      ],
      num_points: 2,
    },
  ],
  lightMoves: [
    {
      id: 1,
      duration: 1,
      type: 0,
      points: [[0, 0, 0]],
      num_points: 1,
    },
    {
      id: 2,
      duration: 0,
      type: 0,
      points: [[0, 0, 0.20000000298023224]],
      num_points: 1,
    },
    {
      id: 3,
      duration: 9,
      type: 0,
      points: [[0, 0, 0]],
      num_points: 1,
    },
    {
      id: 4,
      duration: 1,
      type: 0,
      points: [[0, 0, 0.20000000298023224]],
      num_points: 1,
    },
    {
      id: 5,
      duration: 12,
      type: 0,
      points: [[0, 0, 0]],
      num_points: 1,
    },
    {
      id: 6,
      duration: 1,
      type: 0,
      points: [[0, 0, 0.20000000298023224]],
      num_points: 1,
    },
    {
      id: 7,
      duration: 15,
      type: 0,
      points: [[0, 0, 0]],
      num_points: 1,
    },
    {
      id: 8,
      duration: 1,
      type: 0,
      points: [[0, 0, 0.20000000298023224]],
      num_points: 1,
    },
    {
      id: 9,
      duration: 12,
      type: 0,
      points: [[0, 0, 0]],
      num_points: 1,
    },
    {
      id: 10,
      duration: 1,
      type: 0,
      points: [[0, 0, 0.20000000298023224]],
      num_points: 1,
    },
    {
      id: 11,
      duration: 12,
      type: 0,
      points: [[0, 0, 0]],
      num_points: 1,
    },
    {
      id: 12,
      duration: 1,
      type: 0,
      points: [[0, 0, 0.20000000298023224]],
      num_points: 1,
    },
    {
      id: 13,
      duration: 15,
      type: 0,
      points: [[0, 0, 0]],
      num_points: 1,
    },
    {
      id: 14,
      duration: 1,
      type: 0,
      points: [[0, 0, 0.20000000298023224]],
      num_points: 1,
    },
    {
      id: 15,
      duration: 12,
      type: 0,
      points: [[0, 0, 0]],
      num_points: 1,
    },
    {
      id: 16,
      duration: 1,
      type: 0,
      points: [[0, 0, 0.20000000298023224]],
      num_points: 1,
    },
    {
      id: 17,
      duration: 12,
      type: 0,
      points: [[0, 0, 0]],
      num_points: 1,
    },
    {
      id: 18,
      duration: 1,
      type: 0,
      points: [[0, 0, 0.20000000298023224]],
      num_points: 1,
    },
    {
      id: 19,
      duration: 10,
      type: 0,
      points: [[0, 0, 0]],
      num_points: 1,
    },
    {
      id: 20,
      duration: 0,
      type: 0,
      points: [[0, 0, 0.20000000298023224]],
      num_points: 1,
    },
    {
      id: 21,
      duration: 1,
      type: 0,
      points: [[0, 0, 0]],
      num_points: 1,
    },
    {
      id: 22,
      duration: 0,
      type: 0,
      points: [[0, 0, 0.20000000298023224]],
      num_points: 1,
    },
    {
      id: 23,
      duration: 9,
      type: 0,
      points: [[0, 0, 0]],
      num_points: 1,
    },
    {
      id: 24,
      duration: 1,
      type: 0,
      points: [[0, 0, 0.20000000298023224]],
      num_points: 1,
    },
    {
      id: 25,
      duration: 334,
      type: 0,
      points: [[0, 0, 0]],
      num_points: 1,
    },
    {
      id: 26,
      duration: 1,
      type: 0,
      points: [[0, 0, 0]],
      num_points: 1,
    },
  ],
}

import { useSendMessage } from '@electricui/components-core'
import { CancellationToken, Message } from '@electricui/core'
import React, { useCallback } from 'react'

import { Button } from '@blueprintjs/core'

export function SendToolpath() {
  const sendMessage = useSendMessage()

  const send = useCallback(async () => {
    const cancellationToken = new CancellationToken()

    // Send all toolpaths first
    for (const move of toolpath.movementMoves) {
      const message = new Message('inmv', move)

      await sendMessage(message, cancellationToken)
    }

    // Send all light moves
    for (const fade of toolpath.lightMoves) {
      const message = new Message('inlt', fade)

      await sendMessage(message, cancellationToken)
    }
  }, [sendMessage])

  const sync = useCallback(async () => {
    const cancellationToken = new CancellationToken()
    const syncIDMessage = new Message('syncid', 1)
    await sendMessage(syncIDMessage, cancellationToken)

    const syncMessage = new Message('sync', null)
    await sendMessage(syncMessage, cancellationToken)
  }, [sendMessage])

  const clear = useCallback(async () => {
    const cancellationToken = new CancellationToken()
    const syncMessage = new Message('clmv', null)
    await sendMessage(syncMessage, cancellationToken)
  }, [sendMessage])

  return (
    <>
      <Button onClick={send}>Send toolpath</Button>
      <Button onClick={sync}>Start rendering</Button>
      <Button onClick={clear}>Clear queue</Button>
    </>
  )
}
